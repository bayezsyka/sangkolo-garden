import{r as h,u,j as a,H as q}from"./app-C9tjWG3k.js";import{A as E}from"./AuthenticatedLayout-34lsn5EU.js";import{M as N}from"./Modal-BnN61ZmD.js";import{I as l}from"./InputLabel-tt3dD90s.js";import{I as m,T as y}from"./TextInput-BK7YxOy_.js";import"./transition-BvZaDXXN.js";function $({auth:K,batches:d,varieties:k,availableLocations:t}){const[T,n]=h.useState(!1),[M,r]=h.useState(!1),[i,x]=h.useState(null),{data:p,setData:j,post:w,processing:_,errors:g,reset:L}=u({master_varietas_id:"",jumlah_tanaman:""}),{data:v,setData:o,post:P,processing:f,errors:b,reset:C}=u({batch_id:"",lokasi_tujuan_id:"",jumlah_tanaman_hidup:""}),{put:S,processing:B}=u(),D=e=>{e.preventDefault(),w(route("nursery.store"),{onSuccess:()=>{n(!1),L()}})},H=(e,c)=>{S(route("nursery.update_phase",{batch:e,next_phase:c}))},I=e=>{x(e),o({batch_id:e.id,lokasi_tujuan_id:"",jumlah_tanaman_hidup:e.jumlah_tanaman}),r(!0)},F=e=>{e.preventDefault(),P(route("production.store_pindah_tanam"),{onSuccess:()=>{r(!1),C(),x(null)}})},W=[{key:"persiapan_benih",title:"Perendaman",step:"01",items:d.persiapan_benih||[],nextPhaseTarget:"peram",nextPhaseLabel:"Mulai Peram",isTransfer:!1},{key:"peram",title:"Pemeraman",step:"02",items:d.peram||[],nextPhaseTarget:"semai_tray",nextPhaseLabel:"Pindah ke Tray",isTransfer:!1},{key:"semai_tray",title:"Semai Tray",step:"03",items:d.semai_tray||[],nextPhaseTarget:null,nextPhaseLabel:null,isTransfer:!0}];return a.jsxs(E,{header:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Manajemen Semai"}),a.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:"Kelola pembibitan dari perendaman hingga pindah tanam"})]}),a.jsxs("button",{onClick:()=>n(!0),className:"btn btn-primary gap-1.5",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Tanam Baru"]})]}),children:[a.jsx(q,{title:"Manajemen Semai"}),a.jsx("div",{className:"page-container",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:W.map((e,c)=>a.jsxs("div",{className:`kanban-column animate-fade-in-up stagger-${c+1}`,style:{opacity:0},children:[a.jsxs("div",{className:"column-header",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:e.step}),a.jsx("span",{className:"column-title",children:e.title})]}),a.jsx("span",{className:"column-count",children:e.items.length})]}),a.jsxs("div",{className:"space-y-3",children:[e.items.length===0&&a.jsxs("div",{className:"empty-state !py-8",children:[a.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",strokeWidth:"1",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3v6.75m0 0l-3-3m3 3l3-3M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),a.jsx("span",{className:"empty-text",children:"Kosong"})]}),e.items.map(s=>a.jsxs("div",{className:"kanban-card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[a.jsx("span",{className:"badge badge-light font-mono text-[10px]",children:s.kode_batch}),a.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(s.tanggal_mulai).toLocaleDateString("id-ID",{day:"numeric",month:"short"})})]}),a.jsx("h4",{className:"text-sm font-bold text-gray-900 mb-1",children:s.master_varietas?.nama_varietas||"Unknown"}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-3",children:[a.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25z"})}),a.jsxs("span",{children:[s.jumlah_tanaman," tanaman"]})]}),e.nextPhaseTarget&&a.jsxs("button",{onClick:()=>H(s.id,e.nextPhaseTarget),disabled:B,className:"btn btn-secondary w-full text-xs !py-2",children:[e.nextPhaseLabel,a.jsx("svg",{className:"w-3.5 h-3.5 ml-1",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"})})]}),e.isTransfer&&a.jsxs("button",{onClick:()=>I(s),className:"btn btn-primary w-full text-xs !py-2",children:[a.jsx("svg",{className:"w-3.5 h-3.5 mr-1",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})}),"Pindah Tanam"]})]},s.id))]})]},e.key))})}),a.jsx(N,{show:T,onClose:()=>n(!1),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Batch Tanam Baru"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Mulai siklus tanam baru dari tahap perendaman"})]}),a.jsxs("form",{onSubmit:D,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx(l,{htmlFor:"master_varietas_id",value:"Varietas"}),a.jsxs("select",{id:"master_varietas_id",value:p.master_varietas_id,onChange:e=>j("master_varietas_id",e.target.value),className:"input-field mt-1.5",required:!0,children:[a.jsx("option",{value:"",children:"Pilih varietas..."}),k.map(e=>a.jsx("option",{value:e.id,children:e.nama_varietas},e.id))]}),a.jsx(m,{message:g.master_varietas_id,className:"mt-2"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx(l,{htmlFor:"jumlah_tanaman",value:"Jumlah Tanaman"}),a.jsx(y,{id:"jumlah_tanaman",type:"number",value:p.jumlah_tanaman,onChange:e=>j("jumlah_tanaman",e.target.value),className:"mt-1.5",placeholder:"Contoh: 100",required:!0}),a.jsx(m,{message:g.jumlah_tanaman,className:"mt-2"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn btn-secondary",children:"Batal"}),a.jsx("button",{type:"submit",disabled:_,className:"btn btn-primary",children:_?"Menyimpan...":"Simpan & Mulai"})]})]})]})}),a.jsx(N,{show:M,onClose:()=>r(!1),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Pindah Tanam"}),i&&a.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Batch ",a.jsx("span",{className:"font-mono font-medium text-gray-600",children:i.kode_batch})," â€” ",i.master_varietas?.nama_varietas]})]}),a.jsxs("form",{onSubmit:F,children:[a.jsxs("div",{className:"mb-4",children:[a.jsx(l,{htmlFor:"lokasi_tujuan_id",value:"Lokasi Tujuan"}),a.jsxs("select",{id:"lokasi_tujuan_id",value:v.lokasi_tujuan_id,onChange:e=>o("lokasi_tujuan_id",e.target.value),className:"input-field mt-1.5",required:!0,children:[a.jsx("option",{value:"",children:"Pilih lokasi..."}),t&&t.map(e=>a.jsxs("option",{value:e.id,children:[e.nama_lokasi," (Kapasitas: ",e.kapasitas,")"]},e.id)),(!t||t.length===0)&&a.jsx("option",{value:"",disabled:!0,children:"Tidak ada lokasi kosong"})]}),a.jsx(m,{message:b.lokasi_tujuan_id,className:"mt-2"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx(l,{htmlFor:"jumlah_tanaman_hidup",value:"Jumlah Tanaman Hidup"}),a.jsx(y,{id:"jumlah_tanaman_hidup",type:"number",value:v.jumlah_tanaman_hidup,onChange:e=>o("jumlah_tanaman_hidup",e.target.value),className:"mt-1.5",required:!0}),a.jsxs("p",{className:"mt-1.5 text-[11px] text-gray-400",children:["Jumlah sebelumnya: ",a.jsx("span",{className:"font-semibold text-gray-600",children:i?.jumlah_tanaman})]}),a.jsx(m,{message:b.jumlah_tanaman_hidup,className:"mt-2"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>r(!1),className:"btn btn-secondary",children:"Batal"}),a.jsx("button",{type:"submit",disabled:f,className:"btn btn-primary",children:f?"Memproses...":"Konfirmasi"})]})]})]})})]})}export{$ as default};
