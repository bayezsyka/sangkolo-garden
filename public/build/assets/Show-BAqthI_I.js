import{r as v,u as N,j as e,H as y,L as _}from"./app-C9tjWG3k.js";import{A as k}from"./AuthenticatedLayout-34lsn5EU.js";import{I as n}from"./InputLabel-tt3dD90s.js";import{T as o,I as r}from"./TextInput-BK7YxOy_.js";import"./transition-BvZaDXXN.js";function P({auth:b,batch:s}){const c=v.useRef(null),{data:l,setData:t,post:x,processing:d,errors:i,reset:u}=N({batch_tanam_id:s.id,tanggal:new Date().toISOString().split("T")[0],ppm_nutrisi:"",ph_air:"",suhu_air:"",catatan:"",foto_kondisi:null}),h=a=>{if(!a)return 0;const p=new Date(a),f=Math.abs(new Date-p);return Math.ceil(f/(1e3*60*60*24))},m=s.jurnal_kebuns&&s.jurnal_kebuns.length>0?s.jurnal_kebuns[0]:null,g=a=>{a.preventDefault(),x(route("maintenance.store"),{onSuccess:()=>{u("ppm_nutrisi","ph_air","suhu_air","catatan","foto_kondisi"),c.current&&(c.current.value="")}})},j=h(s.tanggal_mulai);return e.jsxs(k,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Detail Perawatan"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[e.jsx("span",{className:"font-mono",children:s.kode_batch})," — ",s.master_varietas?.nama_varietas]})]}),e.jsxs(_,{href:route("production.index"),className:"btn btn-ghost text-xs gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"Kembali"]})]}),children:[e.jsx(y,{title:`Perawatan - ${s.kode_batch}`}),e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6 animate-fade-in-up",style:{opacity:0},children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("p",{className:"stat-label",children:"Umur"}),e.jsxs("p",{className:"stat-value",children:[j,e.jsx("span",{className:"text-sm text-gray-400 font-normal ml-1",children:"hari"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("p",{className:"stat-label",children:"Jumlah"}),e.jsx("p",{className:"stat-value",children:s.jumlah_tanaman})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("p",{className:"stat-label",children:"PPM Terakhir"}),e.jsx("p",{className:"stat-value",children:m?.ppm_nutrisi||"—"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("p",{className:"stat-label",children:"pH Terakhir"}),e.jsx("p",{className:"stat-value",children:m?.ph_air||"—"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"lg:col-span-1 animate-fade-in-up stagger-2",style:{opacity:0},children:e.jsxs("div",{className:"card-flat p-5 sticky top-20",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-900 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),"Catat Hari Ini"]}),e.jsxs("form",{onSubmit:g,encType:"multipart/form-data",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"tanggal",value:"Tanggal"}),e.jsx(o,{id:"tanggal",type:"date",value:l.tanggal,onChange:a=>t("tanggal",a.target.value),className:"input-field mt-1.5",required:!0}),e.jsx(r,{message:i.tanggal,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"ppm_nutrisi",value:"PPM"}),e.jsx(o,{id:"ppm_nutrisi",type:"number",value:l.ppm_nutrisi,onChange:a=>t("ppm_nutrisi",a.target.value),className:"input-field mt-1.5",placeholder:"1100"}),e.jsx(r,{message:i.ppm_nutrisi,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"ph_air",value:"pH Air"}),e.jsx(o,{id:"ph_air",type:"number",step:"0.1",value:l.ph_air,onChange:a=>t("ph_air",a.target.value),className:"input-field mt-1.5",placeholder:"6.0"}),e.jsx(r,{message:i.ph_air,className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"catatan",value:"Catatan"}),e.jsx("textarea",{id:"catatan",value:l.catatan,onChange:a=>t("catatan",a.target.value),className:"input-field mt-1.5 h-20 resize-none",placeholder:"Tulis kondisi tanaman..."}),e.jsx(r,{message:i.catatan,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"foto_kondisi",value:"Foto (Opsional)"}),e.jsx("input",{ref:c,id:"foto_kondisi",type:"file",accept:"image/*",onChange:a=>t("foto_kondisi",a.target.files[0]),className:"mt-1.5 block w-full text-xs text-gray-500 file:mr-3 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-xs file:font-semibold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200 transition-colors"}),e.jsx(r,{message:i.foto_kondisi,className:"mt-2"})]}),e.jsx("button",{type:"submit",disabled:d,className:"btn btn-primary w-full !py-3",children:d?"Menyimpan...":"Simpan Jurnal"})]})]})}),e.jsx("div",{className:"lg:col-span-2 animate-fade-in-up stagger-3",style:{opacity:0},children:e.jsxs("div",{className:"card-flat p-5 min-h-[400px]",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-500",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"Riwayat Perawatan"]}),e.jsx("div",{children:s.jurnal_kebuns&&s.jurnal_kebuns.length>0?s.jurnal_kebuns.map((a,p)=>e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-dot",children:e.jsx("svg",{fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})}),e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-xs font-semibold text-gray-900",children:new Date(a.tanggal).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.ppm_nutrisi&&e.jsxs("span",{className:"badge badge-light",children:["PPM: ",a.ppm_nutrisi]}),a.ph_air&&e.jsxs("span",{className:"badge badge-light",children:["pH: ",a.ph_air]})]}),a.catatan&&e.jsx("p",{className:"mt-2 text-sm text-gray-500 leading-relaxed whitespace-pre-wrap",children:a.catatan}),a.foto_kondisi&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:`/storage/${a.foto_kondisi}`,alt:"Kondisi",className:"w-20 h-20 object-cover rounded-xl border border-gray-100 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>window.open(`/storage/${a.foto_kondisi}`,"_blank")})})]},a.id)):e.jsxs("div",{className:"empty-state",children:[e.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",strokeWidth:"1",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),e.jsx("span",{className:"empty-text",children:"Belum ada catatan. Mulai catat hari ini!"})]})})]})})]})]})]})}export{P as default};
