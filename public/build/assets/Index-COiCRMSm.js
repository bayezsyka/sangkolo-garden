import{r as m,u as H,j as e,H as S,L as W,b as E}from"./app-Co9wwUI6.js";import{A as I}from"./AuthenticatedLayout-CkjFgVln.js";import{M as D}from"./Modal-DNo-X71d.js";import{I as x}from"./InputLabel-Cv6UIkTz.js";import{T as v,I as h}from"./TextInput-DNionwE1.js";import{P as K}from"./PhaseStopwatch-DVqjOtSZ.js";import"./transition-Od7C6GRL.js";function G({auth:V,locations:i,server_time:y}){const[N,u]=m.useState(!1),[n,t]=m.useState("list"),[r,p]=m.useState(null),{data:g,setData:l,post:_,processing:j,errors:c,reset:f,clearErrors:k}=H({nama_lokasi:"",kapasitas:"",foto_media:null}),w=a=>({persiapan_benih:"Perendaman",peram:"Pemeraman",semai_tray:"Semai Tray",pindah_tanam:"Pindah Tanam",produksi:"Produksi",panen:"Panen"})[a]||a,L=()=>{t("list"),u(!0)},M=()=>{p(null),f(),k(),t("form")},C=a=>{p(a),l({nama_lokasi:a.nama_lokasi,kapasitas:a.kapasitas,foto_media:null}),k(),t("form")},B=a=>{confirm("Apakah Anda yakin ingin menghapus lokasi ini?")&&E.delete(route("production.destroy_location",a.id))},A=a=>{a.preventDefault();const o=r?"production.update_location":"production.store_location",s=r?r.id:{};_(route(o,s),{onSuccess:()=>{f(),t("list")}})},b=i.filter(a=>a.batch_tanams&&a.batch_tanams.length>0).length,P=i.length-b;return e.jsxs(I,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Produksi"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[b," lokasi aktif Â· ",P," tersedia"]})]}),e.jsxs("button",{onClick:L,className:"btn btn-secondary text-xs gap-1.5",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"})}),"Atur Blok"]})]}),children:[e.jsx(S,{title:"Produksi"}),e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:i.map((a,o)=>{const s=a.batch_tanams&&a.batch_tanams.length>0?a.batch_tanams[0]:null,d=!!s,T=s?s.nama_custom||s.master_varietas?.nama_varietas||"Tanpa Nama":"";return e.jsx("div",{className:`location-card ${d?"occupied":"empty"} animate-fade-in-up`,style:{opacity:0,animationDelay:`${o*.04}s`},children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 leading-tight",children:a.nama_lokasi}),e.jsx("span",{className:`badge text-[9px] ${d?"badge-dark":"badge-light"}`,children:d?"Aktif":"Kosong"})]}),d?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-900",children:T}),e.jsx("p",{className:"text-[10px] text-gray-400 font-mono mt-0.5",children:s.kode_batch})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wider",children:"Qty"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 leading-tight",children:s.jumlah_tanaman})]}),e.jsx(K,{startTime:s.tanggal_ubah_fase||s.tanggal_mulai,phaseName:w(s.fase_saat_ini),serverTime:y}),e.jsxs(W,{href:route("production.show",s.id),className:"btn btn-primary w-full text-xs !py-2",children:["Lihat Detail",e.jsx("svg",{className:"w-3.5 h-3.5 ml-1",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center mb-2",children:e.jsx("svg",{className:"w-5 h-5 text-gray-300",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Kapasitas ",a.kapasitas]})]})]})},a.id)})}),i.length===0&&e.jsxs("div",{className:"empty-state mt-12",children:[e.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",strokeWidth:"1",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),e.jsx("span",{className:"empty-text",children:"Belum ada lokasi produksi"})]})]}),e.jsx(D,{show:N,onClose:()=>u(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:n==="list"?"Atur Blok Produksi":r?"Edit Blok":"Tambah Blok Baru"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:n==="list"?"Kelola daftar lokasi produksi, kapasitas, dan media.":"Isi detail lokasi produksi."})]}),n==="form"&&e.jsx("button",{onClick:()=>t("list"),className:"text-xs text-gray-500 hover:text-gray-900",children:"Kembali ke Daftar"})]}),n==="list"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:M,className:"btn btn-primary w-full text-xs justify-center mb-4",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Tambah Blok Baru"]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto space-y-2",children:i.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.foto_media?e.jsx("img",{src:`/storage/${a.foto_media}`,alt:"Media",className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 flex items-center justify-center text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:a.nama_lokasi}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:["Kapasitas: ",a.kapasitas]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>C(a),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),e.jsx("button",{onClick:()=>B(a),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]})]},a.id))})]}):e.jsxs("form",{onSubmit:A,encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(x,{htmlFor:"nama_lokasi",value:"Nama Blok / Lokasi"}),e.jsx(v,{id:"nama_lokasi",type:"text",value:g.nama_lokasi,onChange:a=>l("nama_lokasi",a.target.value),className:"input-field mt-1.5",placeholder:"Contoh: Modul A1",required:!0}),e.jsx(h,{message:c.nama_lokasi,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(x,{htmlFor:"kapasitas",value:"Kapasitas (Lubang Tanam)"}),e.jsx(v,{id:"kapasitas",type:"number",value:g.kapasitas,onChange:a=>l("kapasitas",a.target.value),className:"input-field mt-1.5",placeholder:"Contoh: 200",required:!0}),e.jsx(h,{message:c.kapasitas,className:"mt-2"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(x,{htmlFor:"foto_media",value:"Foto Media (Opsional)"}),e.jsx("input",{id:"foto_media",type:"file",onChange:a=>l("foto_media",a.target.files[0]),className:"mt-1.5 block w-full text-xs text-gray-500 file:mr-3 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-xs file:font-semibold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200 transition-colors",accept:"image/*"}),e.jsx(h,{message:c.foto_media,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t("list"),className:"btn btn-secondary",children:"Batal"}),e.jsx("button",{type:"submit",disabled:j,className:"btn btn-primary",children:j?"Menyimpan...":"Simpan"})]})]})]})})]})}export{G as default};
